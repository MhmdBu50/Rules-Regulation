@model AddNewRecordViewModel
@using Microsoft.AspNetCore.Localization

@{
  var requestCulture = Context.Features.Get<IRequestCultureFeature>();
  var currentCulture = requestCulture?.RequestCulture.Culture.Name ?? "en-US";
  var isArabic = currentCulture == "ar-SA";
  ViewBag.IsArabic = isArabic;
}

@section Styles {
  <link rel="stylesheet" href="~/css/AddNewRecord.css">
  <link rel="stylesheet" href="~/css/adminPagesHeader.css">
  <link rel="stylesheet" href="~/css/adminMobileMenu.css">
}
<!-- javascript files, from js file-->
@section Scripts {
  <script src="~/js/addnewrecord.js"></script>
  <script src="~/lib/bootstrap/dist/js/bootstrap.js"></script>
  <script src="~/js/adminPagesHeader.js"></script>
  <script src="~/js/adminMobileMenu.js"></script>
  <script src="~/js/languageSwitcher.js"></script>
}
<!-- This file contains the view for adding a new record in the admin panel. -->
<!-- It includes a form for entering details about the regulation or manual
     it includes details like name, version number, department, approval date etc. -->
<div class="AddNewRecord mb-footer-space">

  <!-- New Admin Header -->
  @await Html.PartialAsync("adminPagesHeader")

  <!-- Logo -->
  <div class="container logo-container">
    <img class="header-logo mx-auto d-block" src="~/imgs/IAU Logo (Horizontal).png" alt="IAU Logo">
  </div>

  <!-- Main Header -->
  <div class="main-header">
    <!-- New Record -->
    <h1 id="add-record-page-title"></h1>
  </div>

  <!-- Success/Error Messages -->
  <div class="container">
    @if (TempData["SuccessMessage"] != null)
    {
      <div class="alert alert-success alert-dismissible fade show" role="alert">
        @TempData["SuccessMessage"]
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
      </div>
    }
    @if (TempData["ErrorMessage"] != null)
    {
      <div class="alert alert-danger alert-dismissible fade show" role="alert">
        @TempData["ErrorMessage"]
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
      </div>
    }
  </div>

  <!-- Form Section -->
  <div class="container">
    <div class="form-wrapper">
      <form asp-controller="Admin" asp-action="AddNewRecord" method="post" enctype="multipart/form-data">
        @Html.AntiForgeryToken()
        <div class="row mb-3">
          <div class="col-md-6">
            <!-- Regulation/Manual Name (English) -->
            <label for="regulationName" id="label-regulationName"></label>
            <input type="text" class="form-control" id="regulationName" name="regulationName"
              pattern="@Html.Raw("[a-zA-Z0-9\\s\\.\\,\\:\\;\\!\\?\\@\\#\\$\\%\\^\\&\\*\\(\\)\\[\\]\\{\\}\\/\\\\\\&lt;\\&gt;\\-\\_\\+\\=\\&quot;\\'\\|،؟؛\\n\\r]*")"
              title="Please enter only English letters, numbers, spaces, and common punctuation"
              placeholder="e.g., Student Academic Regulations" maxlength="200" required>
            <div id="regulationNameError" class="text-danger mt-1" style="display: none;"></div>
          </div>
          <div class="col-md-6">
            <!-- Regulation/Manual Name (Arabic) -->
            <label for="regulationNameAr" id="label-regulationNameAr"></label>
            <input type="text" class="form-control" id="regulationNameAr" name="regulationNameAr"
              pattern="@Html.Raw("[\\u0600-\\u06FF\\u0750-\\u077F\\u08A0-\\u08FF\\uFB50-\\uFDFF\\uFE70-\\uFEFF0-9\\s\\.\\,\\:\\;\\!\\?\\@\\#\\$\\%\\^\\&\\*\\(\\)\\[\\]\\{\\}\\/\\\\\\&lt;\\&gt;\\-\\_\\+\\=\\&quot;\\'\\|،؟؛\\n\\r]*")"
              title="Please enter Arabic text, numbers, spaces, and common punctuation"
              placeholder="مثال: لوائح الطلاب الأكاديمية 2024" maxlength="200" dir="rtl" lang="ar" required>
            <div id="regulationNameArError" class="text-danger mt-1" style="display: none;"></div>
          </div>
        </div>
      

        <div class="row mb-3">
          <div class="col-md-6">
            <!-- Relevant Department -->
            <label for="relevantDepartment" id="label-relevantDepartment"></label>
            <select class="form-select" id="relevantDepartment" name="relevantDepartment" required>
              <!-- Select department -->
              <option value="" id="select-department1"></option>
              <!-- Reg and Admission -->
              <option value="Reg and Admission" id="option-dept-reg"></option>
              <!-- CCSIT -->
              <option value="CCSIT" id="option-dept-ccsit"></option>
              <!-- Communication and tech -->
              <option value="Communication and tech" id="option-dept-tech"></option>
              <!-- Hospital -->
              <option value="Hospital" id="option-dept-hospital"></option>
              <!-- Library -->
              <option value="Library" id="option-dept-library"></option>
              <!-- Students Affairs -->
              <option value="Students Affairs" id="option-dept-students"></option>
              <!-- preparetory -->
              <option value="Preparetory" id="option-dept-prep"></option>
              <!-- academic affairs -->
              <option value="Academic Affairs" id="option-dept-academic"></option>
            </select>
          </div>
          <div class="col-md-6">
            <!--page number-->
            <!-- Thumbnail Page Number -->
            <label for="pageNumber" id="label-pageNumber"></label>
            <input type="number" class="form-control" name="PageNumber"
              min="1" max="999" value="2" step="1"
              pattern="[0-9]+" inputmode="numeric"
              title="Please enter the page number to use for PDF thumbnail (1-999)" 
              id="pageNumber" placeholder="2" required
              oninput="this.value = this.value.replace(/[^0-9]/g, '')"
              onkeypress="return event.charCode >= 48 && event.charCode <= 57">
            <div id="pageNumberError" class="text-danger mt-1" style="display: none;"></div>
          </div>
        </div>

        
        <div class="row mb-3">
          <div class="col-md-4">
            <!-- Version Number -->
            <label for="versionNumber" id="label-versionNumber"></label>
            <input type="text" class="form-control" id="versionNumber" name="versionNumber" 
              pattern="@Html.Raw("[0-9\\.\\-\\_]*")"
              title="Please enter only numbers, dots, hyphens, and underscores (e.g., 1.0, 2.1.3, v1-0)"
              placeholder="e.g., 1.0, 2.1.3" maxlength="20" required>
          </div>
          <div class="col-md-4">
            <!-- Version Date -->
            <label for="versionDate" id="label-versionDate"></label>
            <input type="date" class="form-control" id="versionDate" name="versionDate" required>
          </div>
          <div class="col-md-4">
            <!-- Approving Date -->
            <label for="ApprovingDate" id="label-approvingDate"></label>
            <input type="date" class="form-control" id="ApprovingDate" name="ApprovingDate" required>
          </div>
        </div>

        <div class="row mb-3">
          <div class="col-md-6">
            <!-- Approving Entity (English) -->
            <label for="ApprovingEntity" id="label-approvingEntity"></label>
            <input type="text" class="form-control" id="ApprovingEntity" name="ApprovingEntity"
              pattern="@Html.Raw("[a-zA-Z0-9\\s\\.\\,\\:\\;\\!\\?\\@\\#\\$\\%\\^\\&\\*\\(\\)\\[\\]\\{\\}\\/\\\\\\&lt;\\&gt;\\-\\_\\+\\=\\&quot;\\'\\|،؟؛\\n\\r]*")"
              title="Please enter only English letters, numbers, spaces, and common punctuation"
              placeholder="e.g., Academic Affairs Committee" maxlength="150" required>
            <div id="ApprovingEntityError" class="text-danger mt-1" style="display: none;"></div>
          </div>
          <div class="col-md-6">
            <!-- Approving Entity (Arabic) -->
            <label for="ApprovingEntityAr" id="label-approvingEntityAr"></label>
            <input type="text" class="form-control" id="ApprovingEntityAr" name="ApprovingEntityAr"
              pattern="@Html.Raw("[\\u0600-\\u06FF\\u0750-\\u077F\\u08A0-\\u08FF\\uFB50-\\uFDFF\\uFE70-\\uFEFF0-9\\s\\.\\,\\:\\;\\!\\?\\@\\#\\$\\%\\^\\&\\*\\(\\)\\[\\]\\{\\}\\/\\\\\\&lt;\\&gt;\\-\\_\\+\\=\\&quot;\\'\\|،؟؛\\n\\r]*")"
              title="Please enter Arabic text, numbers, spaces, and common punctuation"
              placeholder="مثال: لجنة الشؤون الأكاديمية (2024)" maxlength="150" dir="rtl" lang="ar" required>
            <div id="approvingEntityArError" class="text-danger mt-1" style="display: none;"></div>
          </div>
        </div>

        <div class="row mb-3">
          <div class="col-md-6">
            <!-- Word Attachment -->
            <label for="wordAttachment" id="label-wordAttachment"></label>
            <input type="file" class="form-control" id="wordAttachment" name="wordAttachment" accept=".doc,.docx"
              title="Please select a Word document (.doc or .docx file)">
          </div>
          <div class="col-md-6">
            <!-- PDF Attachment -->
            <label for="pdfAttachment" id="label-pdfAttachment"></label>
            <input type="file" class="form-control" id="pdfAttachment" name="pdfAttachment" accept=".pdf"
              title="Please select a PDF document (.pdf file)" required>
            <div id="pdfAttachmentError" class="text-danger mt-1" style="display: none;"></div>
          </div>
        </div>

        <div class="row mb-3">
          <div class="col-md-6">
            <!-- Brief Description (English) -->
            <label for="Description" id="label-description"></label>
            <textarea class="form-control" id="Description" name="Description" rows="3"
              title="Please enter only English letters, numbers, spaces, and common punctuation"
              placeholder="Enter a brief description of the regulation..." maxlength="500"></textarea>
            <div id="DescriptionError" class="text-danger mt-1" style="display: none;"></div>
          </div>
          <div class="col-md-6">
            <!-- Brief Description (Arabic) -->
            <label for="DescriptionAr" id="label-descriptionAr"></label>
            <textarea class="form-control" id="DescriptionAr" name="DescriptionAr" rows="3"
              title="Please enter Arabic text, numbers, spaces, and common punctuation"
              placeholder="أدخل وصفاً مختصراً للائحة مع أرقام إن لزم الأمر..." maxlength="500" dir="rtl"
              lang="ar"></textarea>
            <div id="descriptionArError" class="text-danger mt-1" style="display: none;"></div>
          </div>
        </div>

        <div class="row mb-4">
          <div class="col-md-5">
            <!-- Document Type -->
            <label id="label-doc-type-section-7851"></label>
            <div class="form-check">
              <input class="form-check-input" type="radio" name="doctype" value="Student guides & templates" id="reg"
                required>
                <!-- Student guides &
                templates -->
              <label class="form-check-label" for="reg" id="label-doc-student-guides-7851"></label>
            </div>
            <div class="form-check">
              <input class="form-check-input" type="radio" name="doctype" value="Student rules & regulations"
                id="Guidelines">
                <!-- Student rules &
                regulations -->
              <label class="form-check-label" for="Guidelines" id="label-doc-student-rules-7851"></label>
            </div>
            <div class="form-check">
              <input class="form-check-input" type="radio" name="doctype" value="Employees’ rules & regulations"
                id="policy">
                <!-- Employees’ rules &
                regulations -->
              <label class="form-check-label" for="policy" id="label-doc-employee-rules-7851"></label>
            </div>
            <div class="form-check">
              <input class="form-check-input" type="radio" name="doctype" value="Academic rules & regulations"
                id="Academic">
                <!-- Academic rules & regulations -->
              <label class="form-check-label" for="Academic" id="label-doc-academic-rules-7851"></label>
            </div>
          </div>
        </div>

        <div class="row mb-5">
          <div class="col-md-6">
            <!-- Notes (English) -->
            <label for="notes" id="label-notes"></label>
            <input type="text" class="form-control" id="notes" name="notes"
              pattern="@Html.Raw("[a-zA-Z0-9\\s\\.\\,\\:\\;\\!\\?\\@\\#\\$\\%\\^\\&\\*\\(\\)\\[\\]\\{\\}\\/\\\\\\&lt;\\&gt;\\-\\_\\+\\=\\&quot;\\'\\|،؟؛\\n\\r]*")"
              title="Please enter only English letters, numbers, spaces, and common punctuation"
              placeholder="Optional notes or comments..." maxlength="250">
            <div id="notesError" class="text-danger mt-1" style="display: none;"></div>
          </div>
          <div class="col-md-6">
            <!-- Notes (Arabic) -->
            <label for="notesAr" id="label-notesAr"></label>
            <input type="text" class="form-control" id="notesAr" name="notesAr"
              pattern="@Html.Raw("[\\u0600-\\u06FF\\u0750-\\u077F\\u08A0-\\u08FF\\uFB50-\\uFDFF\\uFE70-\\uFEFF0-9\\s\\.\\,\\:\\;\\!\\?\\@\\#\\$\\%\\^\\&\\*\\(\\)\\[\\]\\{\\}\\/\\\\\\&lt;\\&gt;\\-\\_\\+\\=\\&quot;\\'\\|،؟؛\\n\\r]*")"
              title="Please enter Arabic text, numbers, spaces, and common punctuation"
              placeholder="ملاحظات أو تعليقات اختيارية مع أرقام..." maxlength="250" dir="rtl" lang="ar">
            <div id="notesArError" class="text-danger mt-1" style="display: none;"></div>
          </div>
        </div>

        <div class="text-center mt-4">
          <!-- Save and upload -->
          <button type="submit" class="btn btn-primary me-2" id="btn-save"></button>
          <!-- Cancel -->
          <button type="button" class="btn btn-secondary" onclick="confirmCancel()" id="btn-cancel"></button>
        </div>
      </form>
    </div>
  </div>
</div>

@await Html.PartialAsync("_Footer")